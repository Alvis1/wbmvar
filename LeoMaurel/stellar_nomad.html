<html>
    <head>
        <script src="https://aframe.io/releases/1.7.1/aframe.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.7.9/dat.gui.min.js"></script>
        <script src="res/components/spaceship-controls.js"></script>
        <script src="res/components/sky-follow-camera.js"></script>
        <script src="res/shaders/sky-shader.js"></script>
        <script src="res/components/planet-atmosphere.js"></script>
        <script src="res/components/atmospheric-post-processing.js"></script>
        <script src="res/components/update-atmosphere-uniforms.js"></script>
        <script src="res/components/atmosphere-gui.js"></script>
    </head>
    <body>
        <a-scene stats> <!-- (WIP) atmospheric-post-processing atmosphere-gui> -->
            <a-assets>
                <!-- Grass material -->
                <img id="grass-color" src="res/materials/Grass004/Grass004_2K-JPG_Color.jpg">
                <img id="grass-normal" src="res/materials/Grass004/Grass004_2K-JPG_NormalGL.jpg">
                <img id="grass-roughness" src="res/materials/Grass004/Grass004_2K-JPG_Roughness.jpg">
                <img id="grass-ao" src="res/materials/Grass004/Grass004_2K-JPG_AmbientOcclusion.jpg">
                <img id="grass-displacement" src="res/materials/Grass004/Grass004_2K-JPG_Displacement.jpg">
                
                <!-- Models -->
                <a-asset-item id="spaceship" src="res/models/spaceship.glb"></a-asset-item>
            </a-assets>
            
            <a-icosahedron 
                position="0 1.6 -3"
                scale="800 800 800"
                radius="1"
                detail="6"
                planet-atmosphere="center: 0 1.6 -3; atmosphereRadius: 90; planetRadius: 80; sunPosition: 100 50 -50"
                material="src: #grass-color; 
                          normalMap: #grass-normal; 
                          roughness: 1.0; 
                          roughnessMap: #grass-roughness;
                          aoMap: #grass-ao;
                          repeat: 500 500;
                          normalTextureRepeat: 500 500;
                          roughnessTextureRepeat: 500 500;
                          aoTextureRepeat: 500 500;
                          normalScale: 0.03 0.03">
                >
            </a-icosahedron>
            
            <!-- <a-ring 
                position="0 1.6 -3"
                rotation="-45 25 0"
                radius-inner="29" 
                radius-outer="31" 
                segments-theta="128"
                shadow="cast: true; receive: true"
                material="color: #7a6f63; roughness: 1; metalness: 0; opacity: 0.7; transparent: true; side: double">
            </a-ring> -->
            <a-entity id="sun" position="100 50 -50">
                <a-light type="directional" intensity="0.8" color="#ffeecc" cast-shadow="true">
                </a-light>
                
                <a-light type="ambient" color="#4a5f7a" intensity="0.3">
                </a-light>
            </a-entity>
            
            <a-entity id="spaceship" position="3093 1.6 -417" spaceship-controls>
                <a-entity gltf-model="#spaceship" position="0 -0.4 0.5" rotation="0 180 0">
                </a-entity>
                <a-entity id="cameraRig" position="0 0 0">
                    <a-entity id="head" position="0 0.6 -1" camera="near: 0.1; far: 100000" look-controls="reverseMouseDrag: false" update-atmosphere-uniforms="sunSelector: #sun">
                    </a-entity>
                </a-entity>
            </a-entity>
            
            <a-box 
                id="skybox"
                scale="50000 50000 50000"
                material="shader: sky; 
                          starDensity: 0.003; 
                          starBrightness: 1.5; 
                          sunPosition: 100 50 -50; 
                          sunColor: #FFF1D4; 
                          sunSize: 0.0015; 
                          sunGlow: 0.3;
                          side: back"
                sky-follow-camera>
            </a-box>
        </a-scene>
    </body>
</html>